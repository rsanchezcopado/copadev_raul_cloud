["{\"nodes\":{\"CG_ED_Story_CR_RetailVisitKpi_DaysSinceLastInventoryComplianceCheck\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"daysBetween(toDate(first('ActualVisitStartTime_sec_epoch')), now())\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Days Since Inventory Compliance Check\",\"name\":\"DaysSinceInventoryComplianceCheck\"},{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"ActualValue_Num_Dec_Computed\",\"default\":\"0\"},\"label\":\"Inventory_Actual\",\"name\":\"Inventory_Actual\"},{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"TargetValue_Num_Dec_Computed\",\"default\":\"0\"},\"label\":\"Inventory_Target\",\"name\":\"Inventory_Target\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"ActualVisitStartTime\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_Filter_RetailVisitKpi_DaysSinceLastInventoryComplianceCheck\"]},\"CG_ED_Story_Augment_StoreVisits_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"RetailStoreId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"Store\",\"rightKey\":[\"PlaceId\"],\"rightSelect\":[\"Number_of_Visits\"]},\"sources\":[\"CG_ED_Story_Augment_DaysSinceLastInventoryComplianceCheck_onto_StoreProduct\",\"CG_ED_Story_CE_Visit\"]},\"CG_ED_Story_CR_RetailVisitKpi_DaysSinceLastOOSComplianceCheck\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"saqlExpression\":\"case when first('ActualVisitStartTime_sec_epoch') == current('ActualVisitStartTime_sec_epoch') then 1 else 0 end\",\"type\":\"Numeric\",\"scale\":10},\"label\":\"LastVisit_OOS_Flag\",\"name\":\"LastVisit_OOS_Flag\"},{\"expression\":{\"saqlExpression\":\"daysBetween(toDate(first('ActualVisitStartTime_sec_epoch')), now())\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Days Since OOS Compliance Check\",\"name\":\"DaysSinceOOSComplianceCheck\"},{\"expression\":{\"saqlExpression\":\"case when current('StoreProductId') == next('StoreProductId') && current('ActualVisitStartTime_sec_epoch') == next('ActualVisitStartTime_sec_epoch') then 1 else 0 end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Duplicate_OOS_Record_Flag\",\"name\":\"Duplicate_OOS_Record_Flag\"},{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"ActualBooleanValue\"},\"label\":\"OOS_Actual\",\"name\":\"OOS_Actual\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"ActualVisitStartTime\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_Filter_RetailVisitKpi_DaysSinceLastOOSComplianceCheck\"]},\"CG_ED_Story_Filter_AssessmentTaskOrder_Remove_Duplicates\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'IsDuplicate' == \\\"False\\\"\"},\"sources\":[\"CG_ED_Story_CE_AssessmentTaskOrder_Find_Duplicate_Orders\"]},\"CG_ED_Story_Augment_Location_onto_RetailStore\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LocationId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Location\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Address.City\",\"Address.State\"]},\"sources\":[\"CG_ED_Story_Augment_RetailStoreGroup_onto_RetailStore\",\"CG_ED_Story_Augment_Address_onto_Location\"]},\"CG_ED_Story_CE_PromotionChannel_ComputeEndDate\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"format\":\"yyyy-MM-dd\",\"isYearEndFiscalYear\":true,\"label\":\"EndDate_Computed\",\"name\":\"EndDate_Computed\",\"saqlExpression\":\"case when coalesce(toDate('EndDate', \\\"yyyy-MM-dd\\\"), toDate('Promotion.EndDate', \\\"yyyy-MM-dd\\\")) is null then case when toDate('StartDate', \\\"yyyy-MM-dd\\\") >= toDate(date_to_string(now(),\\\"yyyy-MM-dd\\\"), \\\"yyyy-MM-dd\\\") then toDate('StartDate', \\\"yyyy-MM-dd\\\") else toDate(date_to_string(now(),\\\"yyyy-MM-dd\\\"), \\\"yyyy-MM-dd\\\") end else coalesce(toDate('EndDate', \\\"yyyy-MM-dd\\\"), toDate('Promotion.EndDate', \\\"yyyy-MM-dd\\\")) end\",\"type\":\"Date\"}],\"mergeWithSource\":true},\"sources\":[\"CG_ED_Story_Promotion_onto_PromotionChannel\"]},\"CG_ED_Story_CR_PromotionChannel\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"saqlExpression\":\"case when first('Channel_Rank') == current('Channel_Rank') then 1 else 0 end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"ChannelPriority_Flag\",\"name\":\"ChannelPriority_Flag\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"Channel_Rank\"}],\"partitionBy\":[\"PromotionId\"]},\"sources\":[\"CG_ED_Story_CE_PromotionChannel\"]},\"CG_ED_Story_Filter_RetailVisitKpi_with_VisitStatus\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'AssessmentTask.Visit.VisitsUntilCurrentTime_Flag' == 1 && 'AssessmentTask.Visit.Status' in [\\\"Completed\\\", \\\"Abandoned\\\"]\"},\"sources\":[\"CG_ED_Story_Augment_AssessmentTask_onto_RetailVisitKpi\"]},\"CG_ED_Story_CR_AssessmentTaskOrder_Find_Previous_Orders\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"previous()\",\"sourceField\":\"OrderId\"},\"label\":\"OrderIdPrevious\",\"name\":\"OrderIdPrevious\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"LastModifiedDate\"}],\"partitionBy\":[\"OrderId\"]},\"sources\":[\"CG_ED_Story_Digest_AssessmentTaskOrder\"]},\"CG_ED_Story_Augment_OrderItem_DaysSinceLastOrder_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"OrderItem\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"DaysSinceLastOrder\"]},\"sources\":[\"CG_ED_Story_Augment_OrderItem_onto_StoreProduct\",\"CG_ED_Story_CR_OrderItem_GetDaysSinceLastOrder\"]},\"CG_ED_Story_Filter_PromotionChannel_KeepLatestPromotionEndDateFuture\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"ChannelPriority_Flag == 1 && DaysAfterPromotionEnds >= 0\"},\"sources\":[\"CG_ED_Story_CR_PromotionChannel\"]},\"CG_ED_Story_TD_Augment_LastVisitDatebyStore_onto_Visit\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"PlaceId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LastVisit\",\"rightKey\":[\"RetailStoreId\"],\"rightSelect\":[\"LastVisitDate_by_Store\"]},\"sources\":[\"CG_ED_Story_CE_Visit\",\"CG_ED_Story_TD_CR_GetLastVisitDatebyStore\"]},\"CG_ED_Story_Digest_Promotion\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"EndDate\"},{\"name\":\"Id\"},{\"name\":\"Name\"},{\"name\":\"StartDate\"}],\"object\":\"Promotion\"}},\"CG_ED_Story_Filter_RetailVisitKpi\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'AssessmentTask.Visit.ActualVisitStartTime_SelectedPeriod_Filter_Flag' == 1 && 'Include_In_Compliance' == \\\"True\\\"\"},\"sources\":[\"CG_ED_Story_CE_RetailVisitKpi_ComputeValues\"]},\"CG_ED_Story_TD_CR_GetLastVisitDatebyStore\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"ActualVisitStartTime\"},\"label\":\"LastVisitDate_by_Store\",\"name\":\"LastVisitDate_by_Store\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"ActualVisitStartTime\"}],\"partitionBy\":[\"RetailStoreId\"]},\"sources\":[\"CG_ED_Story_TD_Filter_RetailVisitKpi_OOS_LastVisitRecords\"]},\"CG_ED_Story_TD_Filter_OrderItem_GetOrdersBeforeLVD\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'StoreProductTD.ActualVisitStartTime' is not null && DaysSinceLastOrder_FromLastVisit >= 0\"},\"sources\":[\"CG_ED_Story_CE_OrderItem\"]},\"CG_ED_Story_TD_Slice_StoreProduct\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"ActualBooleanValue\"},{\"name\":\"AssessmentTask.Visit.Id\"},{\"name\":\"ActualVisitStartTime\"},{\"name\":\"StoreProductId\"}],\"mode\":\"select\"},\"sources\":[\"CG_ED_Story_TD_Filter_RetailVisitKpi_OOS_LastVisitRecords\"]},\"CG_ED_Story_TD_Augment_DaysSinceLastOOSComplianceCheck_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"OutOfStock\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"DaysSinceOOSComplianceCheck\",\"OOS_Actual\"]},\"sources\":[\"CG_ED_Story_TD_Augment_DaysSinceLastComplianceCheck_onto_StoreProduct\",\"CG_ED_Story_TD_CR_RetailVisitKpi_DaysSinceLastOOSComplianceCheck\"]},\"CG_ED_Story_TD_CR_RetailVisitKpi_GetLatestPromotionStartDatePast\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"LatestPromotionStartDatePast_TD_Temp\"},\"label\":\"LatestPromotionStartDatePast\",\"name\":\"LatestPromotionStartDatePast\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"LatestPromotionStartDatePast_TD_Temp\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_TD_Filter_RetailVisitKpi_GetPromotions\"]},\"CG_ED_Story_Digest_AssessmentTask\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"TaskType\"},{\"name\":\"Name\"},{\"name\":\"Id\"},{\"name\":\"ParentId\"}],\"object\":\"AssessmentTask\"}},\"CG_ED_Story_TD_Filter_RetailVisitKpi_OOS_LastVisitRecords\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'LastVisit_OOS_Flag' == 1 && 'Duplicate_OOS_Record_Flag' == 0\"},\"sources\":[\"CG_ED_Story_CR_RetailVisitKpi_DaysSinceLastOOSComplianceCheck\"]},\"CG_ED_Story_Digest_PromotionChannel\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"AccountId\"},{\"name\":\"EndDate\"},{\"name\":\"Id\"},{\"name\":\"InStoreLocationId\"},{\"name\":\"Name\"},{\"name\":\"PromotionId\"},{\"name\":\"RetailLocationGroupId\"},{\"name\":\"RetailStoreId\"},{\"name\":\"StartDate\"}],\"object\":\"PromotionChannel\"}},\"CG_ED_Story_Augment_InStoreLocation_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"InStoreLocationId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"InStoreLocation\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"InStoreLocationType\"]},\"sources\":[\"CG_ED_Story_Digest_StoreProduct\",\"CG_ED_Story_Digest_InStoreLocation\"]},\"CG_ED_Story_TD_CR_RetailVisitKpi_GetStoreProductVisits\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"saqlExpression\":\"case when current('AssessmentTask.Visit.Id') == previous('AssessmentTask.Visit.Id') then 0 else 1 end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"StoreProduct_Visits\",\"name\":\"StoreProduct_Visits\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"AssessmentTask.Visit.Id\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_TD_Filter_RetailVisitKpi\"]},\"CG_ED_Story_Digest_RetailVisitKpi\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"ActualBooleanValue\"},{\"name\":\"ActualDecimalValue\"},{\"name\":\"ActualIntegerValue\"},{\"name\":\"AssessmentIndDefinitionId\"},{\"name\":\"AssessmentTaskId\"},{\"name\":\"Id\"},{\"name\":\"InStoreLocationId\"},{\"name\":\"UnitOfMeasure\"},{\"name\":\"Type\"},{\"name\":\"TargetIntegerValue\"},{\"name\":\"TargetDecimalValue\"},{\"name\":\"TargetBooleanValue\"},{\"name\":\"ProductId\"},{\"name\":\"ProductCategoryId\"},{\"name\":\"Name\"},{\"name\":\"PromotionId\"},{\"name\":\"ActualDateTimeValue\"},{\"name\":\"ActualStringValue\"}],\"object\":\"RetailVisitKpi\"}},\"CG_ED_Story_Digest_Location\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"VisitorAddressId\"},{\"name\":\"Id\"}],\"object\":\"Location\"}},\"CG_ED_Story_CR_RetailVisitKpi_DaysSinceLastComplianceCheck\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"saqlExpression\":\"daysBetween(toDate(first('ActualVisitStartTime_sec_epoch')), now())\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Days Since Last Compliance Check\",\"name\":\"DaysSinceLastComplianceCheck\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"ActualVisitStartTime\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_Filter_RetailVisitKpi_DaysSinceLastComplianceCheck\"]},\"CG_ED_Story_TD_Filter_RetailVisitKpi\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'DaysSinceLastOOSVisit'>=0 && 'DaysSinceLastOOSVisit' <= 90 && 'Include_In_Compliance' == \\\"True\\\"\"},\"sources\":[\"CG_ED_Story_TD_CE_RetailVisitKpi_ComputeValues\"]},\"CG_ED_Story_Augment_RetailVisitKpiWithPromotionDates_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Promotion\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"LatestPromotionStartDatePast\",\"LatestPromotionEndDatePast\",\"LatestPromotionEndDateFuture\"]},\"sources\":[\"CG_ED_Story_Augment_StoreVisits_onto_StoreProduct\",\"CG_ED_Story_CR_RetailVisitKpi_GetLatestPromotionEndDateFuture\"]},\"CG_ED_Story_TD_CR_RetailVisitKpi_DaysSinceLastInventoryComplianceCheck\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"saqlExpression\":\"daysBetween(toDate(first('ActualVisitStartTime_sec_epoch')), toDate(current('LastOOSVisit.ActualVisitStartTime_sec_epoch')))\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Days Since Inventory Compliance Check\",\"name\":\"DaysSinceInventoryComplianceCheck\"},{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"ActualValue_Num_Dec_Computed\"},\"label\":\"Inventory_Actual\",\"name\":\"Inventory_Actual\"},{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"TargetValue_Num_Dec_Computed\"},\"label\":\"Inventory_Target\",\"name\":\"Inventory_Target\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"ActualVisitStartTime\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_TD_Filter_RetailVisitKpi_DaysSinceLastInventoryComplianceCheck\"]},\"CG_ED_Story_TR_CR_RetailVisitKpi_LY_SamePeriod_Promotions\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"saqlExpression\":\"case when current('PromotionId') == previous('PromotionId') then 0 else 1 end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Number_of_Promotions\",\"name\":\"Number_of_Promotions\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"PromotionId\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_TD_Filter_RetailVisitKpi_LY_SamePeriod_Promotions\"]},\"CG_ED_Story_TD_CE_StoreProduct_ComputeValues\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Temp\",\"name\":\"Temp\",\"saqlExpression\":\"\\\"NA\\\"\",\"type\":\"Text\"},{\"label\":\"State - City\",\"name\":\"State_City\",\"saqlExpression\":\"'RetailStore.Location.Address.State' +\\\" - \\\"+'RetailStore.Location.Address.City'\",\"type\":\"Text\"},{\"label\":\"Quantity_Change_Percentage_vs_Previous_Period\",\"name\":\"Quantity_Change_Percentage_vs_Previous_Period\",\"precision\":10,\"saqlExpression\":\"('OrderItem.Quantity_Current_Period_TD' - 'OrderItem.Quantity_Previous_Period_TD') / 'OrderItem.Quantity_Previous_Period_TD'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Quantity_Change_Percentage_vs_Coming_Period_LastYear\",\"name\":\"Quantity_Change_Percentage_vs_Coming_Period_LastYear\",\"precision\":10,\"saqlExpression\":\"('OrderItem.Quantity_Current_Period_TD' - 'OrderItem.Quantity_Coming_Period_LastYear_TD') / 'OrderItem.Quantity_Coming_Period_LastYear_TD'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"SoS Compliance\",\"name\":\"ShareOfShelf_Compliance\",\"precision\":10,\"saqlExpression\":\"'RetailVisitKpi.SoS_Compliance_Temp' / 'RetailVisitKpi.SoS_Tasks_Count'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"OOS Compliance\",\"name\":\"OutOfStock_Compliance\",\"precision\":10,\"saqlExpression\":\"'RetailVisitKpi.OutOfStock_Compliance_Temp' / 'RetailVisitKpi.OutOfStock_Tasks_Count'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Facing Compliance\",\"name\":\"Facing_Compliance\",\"precision\":10,\"saqlExpression\":\"'RetailVisitKpi.Facing_Compliance_Temp' / 'RetailVisitKpi.Facing_Tasks_Count'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Promotion Compliance\",\"name\":\"Promotion_Compliance\",\"precision\":10,\"saqlExpression\":\"'RetailVisitKpi.Promotion_Compliance_Temp' / 'RetailVisitKpi.Promotion_Tasks_Count'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Inventory Compliance\",\"name\":\"Inventory_Compliance\",\"precision\":10,\"saqlExpression\":\"'RetailVisitKpi.Inventory_Compliance_Temp' / 'RetailVisitKpi.Inventory_Tasks_Count'\",\"scale\":2,\"type\":\"Numeric\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"isYearEndFiscalYear\":true,\"label\":\"Last_Visit_Date\",\"name\":\"Last_Visit_Date\",\"saqlExpression\":\"toDate('TD.ActualVisitStartTime_sec_epoch')\",\"type\":\"Date\"},{\"label\":\"Quantity_Current_Period\",\"name\":\"Quantity_Current_Period\",\"precision\":10,\"saqlExpression\":\"'OrderItem.Quantity_Current_Period_TD'\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Quantity_Previous_Period\",\"name\":\"Quantity_Previous_Period\",\"precision\":10,\"saqlExpression\":\"'OrderItem.Quantity_Previous_Period_TD'\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Quantity_Coming_Period_LastYear\",\"name\":\"Quantity_Coming_Period_LastYear\",\"precision\":10,\"saqlExpression\":\"'OrderItem.Quantity_Coming_Period_LastYear_TD'\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Store_Visits\",\"name\":\"Store_Visits\",\"precision\":10,\"saqlExpression\":\"'Store.Number_of_Visits_TD'\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Dataset Type\",\"name\":\"Dataset_Type\",\"saqlExpression\":\"\\\"TD\\\"\",\"type\":\"Text\"},{\"label\":\"OOS_Kpi_ActualValue\",\"name\":\"OOS_Kpi_ActualValue\",\"saqlExpression\":\"'TD.ActualBooleanValue'\",\"type\":\"Text\"},{\"format\":\"yyyy-MM-dd\",\"isYearEndFiscalYear\":true,\"label\":\"LatestPromotionStartDatePast\",\"name\":\"LatestPromotionStartDatePast\",\"saqlExpression\":\"case when toDate('Promotion.LatestPromotionStartDatePast', \\\"yyyy-MM-dd\\\") != toDate(\\\"1970-01-01\\\", \\\"yyyy-MM-dd\\\") then toDate('Promotion.LatestPromotionStartDatePast', \\\"yyyy-MM-dd\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd\",\"isYearEndFiscalYear\":true,\"label\":\"LatestPromotionEndDatePast\",\"name\":\"LatestPromotionEndDatePast\",\"saqlExpression\":\"case when toDate('Promotion.LatestPromotionEndDatePast', \\\"yyyy-MM-dd\\\") != toDate(\\\"1970-01-01\\\", \\\"yyyy-MM-dd\\\") then toDate('Promotion.LatestPromotionEndDatePast', \\\"yyyy-MM-dd\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd\",\"isYearEndFiscalYear\":true,\"label\":\"LatestPromotionEndDateFuture\",\"name\":\"LatestPromotionEndDateFuture\",\"saqlExpression\":\"case when toDate('Promotion.LatestPromotionEndDateFuture', \\\"yyyy-MM-dd\\\") != toDate(\\\"1970-01-01\\\", \\\"yyyy-MM-dd\\\") then toDate('Promotion.LatestPromotionEndDateFuture', \\\"yyyy-MM-dd\\\") end\",\"type\":\"Date\"}],\"mergeWithSource\":true},\"sources\":[\"CG_ED_Story_TD_Augment_RetailVisitKpiWithPromotionDates_onto_StoreProduct\"]},\"CG_ED_Story_Augment_LatestPromotionEndDateFuture_onto_RetailVisitKpi\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"PromotionId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Promotion\",\"rightKey\":[\"PromotionId\"],\"rightSelect\":[\"LatestPromotionEndDateFuture\"]},\"sources\":[\"CG_ED_Story_Augment_LatestPromotionEndDatePast_onto_RetailVisitKpi\",\"CG_ED_Story_CR_PromotionChannel_GetLatestPromotionEndDateFuture\"]},\"CG_ED_Story_Digest_ProductCategory\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Name\"}],\"object\":\"ProductCategory\"}},\"CG_ED_Story_CR_RetailVisitKpi_GetLatestPromotionEndDateFuture\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"LatestPromotionEndDateFuture_Temp\"},\"label\":\"LatestPromotionEndDateFuture\",\"name\":\"LatestPromotionEndDateFuture\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"LatestPromotionEndDateFuture_Temp\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_CR_RetailVisitKpi_GetLatestPromotionEndDatePast\"]},\"CG_ED_Story_TD_Augment_RetailVisitKpiWithPromotionDates_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Promotion\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"LatestPromotionEndDatePast\",\"LatestPromotionStartDatePast\",\"LatestPromotionEndDateFuture\"]},\"sources\":[\"CG_ED_Story_TD_Augment_RetailVisitKpi_LYSamePeriodPromotions_onto_StoreProduct\",\"CG_ED_Story_TD_CR_RetailVisitKpi_GetLatestPromotionEndDateFuture\"]},\"CG_ED_Story_CE_PromotionChannel\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Channel_Rank\",\"name\":\"Channel_Rank\",\"precision\":10,\"saqlExpression\":\"case when 'RetailStoreId' is not null then 1 when 'AccountId' is not null then 2 when 'RetailLocationGroupId' is not null then 3 else 4 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"DaysSincePromotionStarted\",\"name\":\"DaysSincePromotionStarted\",\"precision\":10,\"saqlExpression\":\"daysBetween(toDate(StartDate_sec_epoch), now())\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"DaysSincePromotionEnded\",\"name\":\"DaysSincePromotionEnded\",\"precision\":10,\"saqlExpression\":\"daysBetween(toDate(EndDate_Computed_sec_epoch), now())\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"DaysAfterPromotionEnds\",\"name\":\"DaysAfterPromotionEnds\",\"precision\":10,\"saqlExpression\":\"daysBetween(now(), toDate(EndDate_Computed_sec_epoch))\",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"CG_ED_Story_CE_PromotionChannel_ComputeEndDate\"]},\"CG_ED_Story_CE_Visit\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"ActualVisitStartTime_SelectedPeriod_Filter_Flag\",\"name\":\"ActualVisitStartTime_SelectedPeriod_Filter_Flag\",\"precision\":10,\"saqlExpression\":\"case when date('ActualVisitStartTime_Year', 'ActualVisitStartTime_Month', 'ActualVisitStartTime_Day') in [\\\"90 days ago\\\"..\\\"current day\\\"] then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"ActualVisitStartTime_LastYear_SamePeriod_Filter_Flag\",\"name\":\"ActualVisitStartTime_LastYear_SamePeriod_Filter_Flag\",\"precision\":10,\"saqlExpression\":\"case when date('ActualVisitStartTime_Year', 'ActualVisitStartTime_Month', 'ActualVisitStartTime_Day') in [\\\"90 days ago - 1 year\\\"..\\\"current day - 1 year\\\"] then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Visit Status - [InProgress Completed Abandoned]\",\"name\":\"VisitStatus_ICA\",\"precision\":10,\"saqlExpression\":\"case when 'Status' in [\\\"InProgress\\\", \\\"Completed\\\", \\\"Abandoned\\\"]  then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Number_of_Visits\",\"name\":\"Number_of_Visits\",\"precision\":10,\"saqlExpression\":\"case when VisitStatus_ICA == 1 && ActualVisitStartTime_SelectedPeriod_Filter_Flag == 1 then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"VisitsUntilCurrentTime_Flag\",\"name\":\"VisitsUntilCurrentTime_Flag\",\"precision\":10,\"saqlExpression\":\"case when daysBetween(toDate(ActualVisitStartTime_sec_epoch), now())>0 then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"isYearEndFiscalYear\":true,\"label\":\"CurrentDay\",\"name\":\"CurrentDay\",\"saqlExpression\":\"toDate(date_to_epoch(now())+86399 - (date_to_epoch(now())- (86400 * floor(date_to_epoch(now())/86400))))\",\"type\":\"Date\"}],\"mergeWithSource\":true},\"sources\":[\"CG_ED_Story_Digest_Visit\"]},\"CG_ED_Story_TD_Filter_RetailVisitKpi_DaysSinceLastComplianceCheck\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'Include_In_Compliance' == \\\"True\\\" &&  'DaysSinceLastOOSVisit' >= 0 && PriorVisit_Flag == 1\"},\"sources\":[\"CG_ED_Story_TD_CE_RetailVisitKpi_ComputeValues\"]},\"CG_ED_Story_Digest_InStoreLocation\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"RetailStoreId\"},{\"name\":\"Name\"},{\"name\":\"InStoreLocationType\"},{\"name\":\"Id\"}],\"object\":\"InStoreLocation\"}},\"CG_ED_Story_Filter_RetailVisitKpi_DaysSinceLastInventoryComplianceCheck\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"Type == \\\"Inventory\\\"\"},\"sources\":[\"CG_ED_Story_Filter_RetailVisitKpi_DaysSinceLastComplianceCheck\"]},\"CG_ED_Story_Augment_AssessmentTask_onto_AssessmentTaskOrder\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"AssessmentTaskId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"AssessmentTask\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Visit.PlaceId\",\"Visit.Id\"]},\"sources\":[\"CG_ED_Story_Filter_AssessmentTaskOrder_Remove_Duplicates\",\"CG_ED_Story_Augment_Visit_onto_AssessmentTask\"]},\"CG_ED_Story_TD_CE_Visit\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"ActualVisitStartTime_SelectedPeriod_FilterFlag_TD\",\"name\":\"DaysSinceLastVisit_TD\",\"precision\":10,\"saqlExpression\":\"case when 'LastVisit.LastVisitDate_by_Store' is not null then  daysBetween(toDate(ActualVisitStartTime_sec_epoch), toDate('LastVisit.LastVisitDate_by_Store_sec_epoch')) end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Number_of_Visits_TD\",\"name\":\"Number_of_Visits_TD\",\"precision\":10,\"saqlExpression\":\"case when 'VisitStatus_ICA' == 1 && 'DaysSinceLastVisit_TD' >= 0 && 'DaysSinceLastVisit_TD' <= 90 then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"CG_ED_Story_TD_Augment_LastVisitDatebyStore_onto_Visit\"]},\"CG_ED_Story_Filter_PromotionChannel_KeepLatestPromotionEndDatePast\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"ChannelPriority_Flag == 1 && DaysSincePromotionEnded >= 0\"},\"sources\":[\"CG_ED_Story_CR_PromotionChannel\"]},\"CG_ED_Story_TD_Augment_StoreProduct_onto_OrderItem\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Product2Id\",\"Order.AssessmentTaskOrder.AssessmentTask.Visit.PlaceId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"StoreProductTD\",\"rightKey\":[\"ProductId\",\"RetailStoreId\"],\"rightSelect\":[\"ActualVisitStartTime\",\"ActualVisitStartTime_FS_ComingPeriod_LY\"]},\"sources\":[\"CG_ED_Story_Augment_Order_onto_OrderItem\",\"CG_ED_Story_TD_Filter_RetailVisitKpi_OOS_LastVisitRecords\"]},\"CG_ED_Story_CR_RetailVisitKpi_LY_SamePeriod_Promotions\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"saqlExpression\":\"case when current('PromotionId') == previous('PromotionId') then 0 else 1 end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Number_of_Promotions\",\"name\":\"Number_of_Promotions\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"PromotionId\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_Filter_RetailVisitKpi_LY_SamePeriod_Promotions\"]},\"CG_ED_Story_Augment_Order_onto_OrderItem\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"OrderId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Order\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"ActivatedDate\",\"AssessmentTaskOrder.AssessmentTask.Visit.PlaceId\",\"AssessmentTaskOrder.AssessmentTask.Visit.Id\"]},\"sources\":[\"CG_ED_Story_Digest_OrderItem\",\"CG_ED_Story_Augment_AssessmentTaskOrder_onto_Order\"]},\"CG_ED_Story_Augment_DaysSinceLastOOSComplianceCheck_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"OutOfStock\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"DaysSinceOOSComplianceCheck\",\"OOS_Actual\"]},\"sources\":[\"CG_ED_Story_Augment_DaysSinceLastComplianceCheck_onto_StoreProduct\",\"CG_ED_Story_CR_RetailVisitKpi_DaysSinceLastOOSComplianceCheck\"]},\"CG_ED_Story_TD_CR_RetailVisitKpi_DaysSinceLastOOSComplianceCheck\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"saqlExpression\":\"daysBetween(toDate(first('ActualVisitStartTime_sec_epoch')), toDate(current('LastOOSVisit.ActualVisitStartTime_sec_epoch')))\",\"type\":\"Numeric\"},\"label\":\"Days Since OOS Compliance Check\",\"name\":\"DaysSinceOOSComplianceCheck\"},{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"ActualBooleanValue\"},\"label\":\"OOS_Actual\",\"name\":\"OOS_Actual\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"ActualVisitStartTime\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_TD_Filter_RetailVisitKpi_DaysSinceLastOOSComplianceCheck\"]},\"CG_ED_Story_Slice_StoreProduct_GetStoreProduct\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"ProductId\"},{\"name\":\"StoreProductId\"},{\"name\":\"RetailStoreId\"}],\"mode\":\"select\"},\"sources\":[\"CG_ED_Story_Filter_RetailVisitKpi_GetStoreProduct\"]},\"CG_ED_Story_Register_StoreProduct\":{\"action\":\"register\",\"parameters\":{\"label\":\"CG_Minimize_OutOfStock_Occurrences_ED\",\"name\":\"CG_Minimize_OutOfStock_Occurrences_ED\"},\"sources\":[\"CG_ED_Story_Append_TD_SD_Data\"]},\"CG_ED_Story_Augment_StoreProductTD_onto_StoreProductSD\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"TD\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"ActualBooleanValue\",\"AssessmentTask.Visit.Id\",\"ActualVisitStartTime\"]},\"sources\":[\"CG_ED_Story_Augment_ProductCategory_onto_StoreProduct\",\"CG_ED_Story_TD_Slice_StoreProduct\"]},\"CG_ED_Story_CE_RetailVisitKpi_ComputeValues\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Target_Empty_Flag\",\"name\":\"Target_Empty_Flag\",\"saqlExpression\":\"case when 'AssessmentIndicatorDefinition.DataType' == \\\"Number\\\" then case when 'ActualIntegerValue' is not null && 'TargetIntegerValue' is null then \\\"True\\\" else \\\"False\\\" end\\nwhen 'AssessmentIndicatorDefinition.DataType' == \\\"Decimal\\\" then case when 'ActualDecimalValue' is not null && 'TargetDecimalValue' is null then \\\"True\\\" else \\\"False\\\" end\\nwhen 'AssessmentIndicatorDefinition.DataType' == \\\"Boolean\\\" then case when 'ActualBooleanValue' is not null && 'TargetBooleanValue' is null then \\\"True\\\" else \\\"False\\\" end end\",\"type\":\"Text\"},{\"label\":\"ActualValue_Num_Dec_Computed\",\"name\":\"ActualValue_Num_Dec_Computed\",\"precision\":16,\"saqlExpression\":\"case when 'AssessmentIndicatorDefinition.DataType' == \\\"Number\\\" then 'ActualIntegerValue' when 'AssessmentIndicatorDefinition.DataType' == \\\"Decimal\\\" then 'ActualDecimalValue' end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"TargetValue_Num_Dec_Computed\",\"name\":\"TargetValue_Num_Dec_Computed\",\"precision\":16,\"saqlExpression\":\"case when 'AssessmentIndicatorDefinition.DataType' == \\\"Number\\\" then 'TargetIntegerValue' when 'AssessmentIndicatorDefinition.DataType' == \\\"Decimal\\\" then 'TargetDecimalValue' end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"ActualValue_Num_Dec_Adjusted\",\"name\":\"ActualValue_Num_Dec_Adjusted\",\"precision\":16,\"saqlExpression\":\"case when 'Target_Empty_Flag' == \\\"False\\\" && 'ActualValue_Num_Dec_Computed' > 'TargetValue_Num_Dec_Computed' then 'TargetValue_Num_Dec_Computed' else 'ActualValue_Num_Dec_Computed' end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Fill_Target_Num_Dec_when_Empty\",\"name\":\"Fill_Target_Num_Dec_when_Empty\",\"precision\":16,\"saqlExpression\":\"case when 'Type' in [\\\"Facing\\\",\\\"ShareOfShelf\\\", \\\"Inventory\\\"] && 'AssessmentIndicatorDefinition.DataType' in [\\\"Number\\\", \\\"Decimal\\\"] && 'Target_Empty_Flag' == \\\"True\\\" then 'ActualValue_Num_Dec_Computed' else 'TargetValue_Num_Dec_Computed' end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Fill_Target_Boolean_when_Empty\",\"name\":\"Fill_Target_Boolean_when_Empty\",\"saqlExpression\":\"case when 'AssessmentIndicatorDefinition.DataType' == \\\"Boolean\\\" then case when 'Target_Empty_Flag' == \\\"False\\\" then 'TargetBooleanValue' else case when 'Type' != \\\"OutOfStock\\\" && 'ActualBooleanValue'==\\\"True\\\" then 'ActualBooleanValue' else \\\"False\\\" end end end\",\"type\":\"Text\"},{\"label\":\"ActualValue_Computed\",\"name\":\"ActualValue_Computed\",\"precision\":16,\"saqlExpression\":\"case when 'AssessmentIndicatorDefinition.DataType' in [\\\"Number\\\",\\\"Decimal\\\"] then 'ActualValue_Num_Dec_Adjusted' when 'AssessmentIndicatorDefinition.DataType' == \\\"Boolean\\\" then \\ncase when 'ActualBooleanValue' == \\\"True\\\" then 1 else 0 end end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"TargetValue_Computed\",\"name\":\"TargetValue_Computed\",\"precision\":16,\"saqlExpression\":\"case when 'AssessmentIndicatorDefinition.DataType' in [\\\"Number\\\",\\\"Decimal\\\"] then 'Fill_Target_Num_Dec_when_Empty' when 'AssessmentIndicatorDefinition.DataType' == \\\"Boolean\\\" then case when 'Fill_Target_Boolean_when_Empty' == \\\"True\\\" then 1 else 0 end end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"NonCompliance_Percentage\",\"name\":\"NonCompliance_Percentage\",\"precision\":16,\"saqlExpression\":\"case when 'AssessmentIndicatorDefinition.DataType' == \\\"Boolean\\\" then abs('ActualValue_Computed' - 'TargetValue_Computed')*100 else abs('ActualValue_Computed' - 'TargetValue_Computed')/'TargetValue_Computed' *100 end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Compliance_Percentage\",\"name\":\"Compliance_Percentage\",\"precision\":16,\"saqlExpression\":\"100 - 'NonCompliance_Percentage'\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Target_n_Actual_Values_Present_Flag\",\"name\":\"Target_n_Actual_Values_Present_Flag\",\"saqlExpression\":\"case when 'AssessmentIndicatorDefinition.DataType' == \\\"Number\\\" && 'ActualIntegerValue' is not null then \\\"True\\\" when 'AssessmentIndicatorDefinition.DataType' == \\\"Decimal\\\" && 'ActualDecimalValue' is not null then \\\"True\\\" when 'AssessmentIndicatorDefinition.DataType' == \\\"Boolean\\\" && 'ActualBooleanValue' is not null then \\\"True\\\" else \\\"False\\\" end\",\"type\":\"Text\"},{\"label\":\"Include in Compliance - Temp\",\"name\":\"Include_In_Compliance_Temp\",\"saqlExpression\":\"case when 'AssessmentIndicatorDefinition.DataType' in [\\\"Number\\\",\\\"Decimal\\\"] && 'Type' in [\\\"Facing\\\",\\\"ShareOfShelf\\\", \\\"Inventory\\\"] then \\\"True\\\" when 'AssessmentIndicatorDefinition.DataType' == \\\"Boolean\\\" && ('PromotionId' is not null || 'Type' == \\\"OutOfStock\\\") then \\\"True\\\" else \\\"False\\\" end\",\"type\":\"Text\"},{\"label\":\"Include In Compliance?\",\"name\":\"Include_In_Compliance\",\"saqlExpression\":\"case when 'Target_n_Actual_Values_Present_Flag' == \\\"True\\\" && 'Include_In_Compliance_Temp' == \\\"True\\\" then \\\"True\\\" else \\\"False\\\" end\",\"type\":\"Text\"},{\"label\":\"Type_Computed\",\"name\":\"Type_Computed\",\"saqlExpression\":\"case when 'PromotionId' is not null then \\\"Promotion\\\" else 'Type' end\",\"type\":\"Text\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"isYearEndFiscalYear\":false,\"label\":\"ActualVisitStartTime\",\"name\":\"ActualVisitStartTime\",\"saqlExpression\":\"toDate('AssessmentTask.Visit.ActualVisitStartTime_sec_epoch')\",\"type\":\"Date\"},{\"label\":\"SoS_Compliance_Temp\",\"name\":\"SoS_Compliance_Temp\",\"precision\":16,\"saqlExpression\":\"case when 'Type_Computed' == \\\"ShareOfShelf\\\" then Compliance_Percentage end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"SoS_Tasks_Count\",\"name\":\"SoS_Tasks_Count\",\"precision\":10,\"saqlExpression\":\"case when 'Type_Computed' == \\\"ShareOfShelf\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"OutOfStock_Compliance_Temp\",\"name\":\"OutOfStock_Compliance_Temp\",\"precision\":16,\"saqlExpression\":\"case when 'Type_Computed' == \\\"OutOfStock\\\" then Compliance_Percentage end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"OutOfStock_Tasks_Count\",\"name\":\"OutOfStock_Tasks_Count\",\"precision\":10,\"saqlExpression\":\"case when 'Type_Computed' == \\\"OutOfStock\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Promotion_Compliance_Temp\",\"name\":\"Promotion_Compliance_Temp\",\"precision\":16,\"saqlExpression\":\"case when 'Type_Computed' == \\\"Promotion\\\" then Compliance_Percentage end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Promotion_Tasks_Count\",\"name\":\"Promotion_Tasks_Count\",\"precision\":10,\"saqlExpression\":\"case when 'Type_Computed' == \\\"Promotion\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Facing_Compliance_Temp\",\"name\":\"Facing_Compliance_Temp\",\"precision\":16,\"saqlExpression\":\"case when 'Type_Computed' == \\\"Facing\\\" then Compliance_Percentage end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Facing_Tasks_Count\",\"name\":\"Facing_Tasks_Count\",\"precision\":10,\"saqlExpression\":\"case when 'Type_Computed' == \\\"Facing\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Inventory_Compliance_Temp\",\"name\":\"Inventory_Compliance_Temp\",\"precision\":16,\"saqlExpression\":\"case when 'Type_Computed' == \\\"Inventory\\\" then Compliance_Percentage end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Inventory_Tasks_Count\",\"name\":\"Inventory_Tasks_Count\",\"precision\":10,\"saqlExpression\":\"case when 'Type_Computed' == \\\"Inventory\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"StoreProductId\",\"name\":\"StoreProductId\",\"saqlExpression\":\"'AssessmentTask.Visit.PlaceId'+\\\"-\\\"+'ProductId'\",\"type\":\"Text\"},{\"label\":\"StoreProduct_Exists_Flag\",\"name\":\"StoreProduct_Exists_Flag\",\"precision\":10,\"saqlExpression\":\"case when 'AssessmentTask.Visit.PlaceId' is not null && 'ProductId' is not null then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"RetailStoreId\",\"name\":\"RetailStoreId\",\"saqlExpression\":\"'AssessmentTask.Visit.PlaceId'\",\"type\":\"Text\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"isYearEndFiscalYear\":true,\"label\":\"ActualVisitStartTime_FS_ComingPeriod_LY\",\"name\":\"ActualVisitStartTime_FS_ComingPeriod_LY\",\"saqlExpression\":\"toDate(number_to_string(string_to_number(toString(toDate('AssessmentTask.Visit.ActualVisitStartTime_sec_epoch'),\\\"yyyy\\\"))-1, \\\"#\\\")+\\\"-\\\"+toString(toDate('AssessmentTask.Visit.ActualVisitStartTime_sec_epoch'+86400),\\\"MM-dd\\\"),\\\"yyyy-MM-dd\\\")\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"isYearEndFiscalYear\":true,\"label\":\"CurrentDay\",\"name\":\"CurrentDay\",\"saqlExpression\":\"toDate(date_to_epoch(now())+86399 - (date_to_epoch(now())- (86400 * floor(date_to_epoch(now())/86400))))\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd\",\"isYearEndFiscalYear\":true,\"label\":\"LatestPromotionStartDatePast_Temp\",\"name\":\"LatestPromotionStartDatePast_Temp\",\"saqlExpression\":\"coalesce(toDate('Promotion.LatestPromotionStartDatePast', \\\"yyyy-MM-dd\\\"), toDate(\\\"1970-01-01\\\", \\\"yyyy-MM-dd\\\"))\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd\",\"isYearEndFiscalYear\":true,\"label\":\"LatestPromotionEndDatePast_Temp\",\"name\":\"LatestPromotionEndDatePast_Temp\",\"saqlExpression\":\"coalesce(toDate('Promotion.LatestPromotionEndDatePast', \\\"yyyy-MM-dd\\\"), toDate(\\\"1970-01-01\\\", \\\"yyyy-MM-dd\\\"))\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd\",\"isYearEndFiscalYear\":true,\"label\":\"LatestPromotionEndDateFuture_Temp\",\"name\":\"LatestPromotionEndDateFuture_Temp\",\"saqlExpression\":\"coalesce(toDate('Promotion.LatestPromotionEndDateFuture', \\\"yyyy-MM-dd\\\"), toDate(\\\"1970-01-01\\\", \\\"yyyy-MM-dd\\\"))\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"isYearEndFiscalYear\":true,\"label\":\"ActualVisitStartTime Last Second SamePeriod Last Year\",\"name\":\"ActualVisitStartTime_LS_SamePeriod_LY\",\"saqlExpression\":\"toDate(date_to_epoch(toDate(number_to_string(string_to_number(toString(toDate('AssessmentTask.Visit.ActualVisitStartTime_sec_epoch'),\\\"yyyy\\\"))-1, \\\"#\\\")+\\\"-\\\"+toString(toDate('AssessmentTask.Visit.ActualVisitStartTime_sec_epoch'+86400),\\\"MM-dd\\\"),\\\"yyyy-MM-dd\\\"))+86399)\",\"type\":\"Date\"}],\"mergeWithSource\":true},\"sources\":[\"CG_ED_Story_Augment_LatestPromotionEndDateFuture_onto_RetailVisitKpi\"]},\"CG_ED_Story_CR_PromotionChannel_GetLatestPromotionStartDatePast\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"StartDate\"},\"label\":\"LatestPromotionStartDatePast\",\"name\":\"LatestPromotionStartDatePast\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"DaysSincePromotionStarted\"}],\"partitionBy\":[\"PromotionId\"]},\"sources\":[\"CG_ED_Story_Filter_PromotionChannel_KeepLatestPromotionStartDatePast\"]},\"CG_ED_Story_Augment_Product_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ProductId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Product\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\",\"Family\"]},\"sources\":[\"CG_ED_Story_Augment_RetailStore_onto_StoreProduct\",\"CG_ED_Story_Digest_Product\"]},\"CG_ED_Story_Augment_Visit_onto_AssessmentTask\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ParentId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Visit\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"ActualVisitStartTime\",\"Id\",\"Status\",\"PlaceId\",\"ActualVisitStartTime_SelectedPeriod_Filter_Flag\",\"VisitsUntilCurrentTime_Flag\",\"ActualVisitStartTime_LastYear_SamePeriod_Filter_Flag\",\"CurrentDay\"]},\"sources\":[\"CG_ED_Story_Digest_AssessmentTask\",\"CG_ED_Story_CE_Visit\"]},\"CG_ED_Story_TD_Augment_OrderItem_DaysSinceLastOrder_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"OrderItem\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"DaysSinceLastOrder\"]},\"sources\":[\"CG_ED_Story_TD_Augment_OrderItem_onto_StoreProduct\",\"CG_ED_Story_TD_CR_OrderItem_GetDaysSinceLastOrder_SinceLWD\"]},\"CG_ED_Story_Digest_RetailStore\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"AccountId\"},{\"name\":\"Id\"},{\"name\":\"StoreType\"},{\"name\":\"RetailLocationGroupId\"},{\"name\":\"Priority\"},{\"name\":\"PrimaryContactId\"},{\"name\":\"Name\"},{\"name\":\"LocationId\"}],\"object\":\"RetailStore\"}},\"CG_ED_Story_TD_Augment_StoreVisits_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"RetailStoreId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"Store\",\"rightKey\":[\"PlaceId\"],\"rightSelect\":[\"Number_of_Visits_TD\"]},\"sources\":[\"CG_ED_Story_TD_Augment_DaysSinceLastInventoryComplianceCheck_onto_StoreProduct\",\"CG_ED_Story_TD_CE_Visit\"]},\"CG_ED_Story_CR_RetailVisitKpi_GetPromoCount\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"saqlExpression\":\"case when 'PromotionId' is not null then case when current('PromotionId') == previous('PromotionId') then 0 else 1 end end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Number_of_Promotions\",\"name\":\"Number_of_Promotions\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"PromotionId\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_CR_RetailVisitKpi_GetStoreProductVisits\"]},\"CG_ED_Story_TD_CR_RetailVisitKpi_GetLatestPromotionEndDateFuture\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"LatestPromotionEndDateFuture_TD_Temp\"},\"label\":\"LatestPromotionEndDateFuture\",\"name\":\"LatestPromotionEndDateFuture\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"LatestPromotionEndDateFuture_TD_Temp\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_TD_CR_RetailVisitKpi_GetLatestPromotionEndDatePast\"]},\"CG_ED_Story_TD_CR_RetailVisitKpi_GetLatestPromotionEndDatePast\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"LatestPromotionEndDatePast_TD_Temp\"},\"label\":\"LatestPromotionEndDatePast\",\"name\":\"LatestPromotionEndDatePast\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"LatestPromotionEndDatePast_TD_Temp\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_TD_CR_RetailVisitKpi_GetLatestPromotionStartDatePast\"]},\"CG_ED_Story_TD_Filter_RetailVisitKpi_GetPromotions\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'PromotionId' is not null\"},\"sources\":[\"CG_ED_Story_TD_CE_RetailVisitKpi_ComputeValues\"]},\"CG_ED_Story_TD_CE_RetailVisitKpi_ComputeValues\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"DaysSinceLastOOSVisit\",\"name\":\"DaysSinceLastOOSVisit\",\"precision\":10,\"saqlExpression\":\"daysBetween(toDate('ActualVisitStartTime_sec_epoch'), toDate('LastOOSVisit.ActualVisitStartTime_sec_epoch'))\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Prior to Last Visit Flag\",\"name\":\"PriorVisit_Flag\",\"precision\":10,\"saqlExpression\":\"case when 'ActualVisitStartTime_sec_epoch' == 'LastOOSVisit.ActualVisitStartTime_sec_epoch' then 0 else 1 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"DaysSinceLastOOSVisit_LY\",\"name\":\"DaysSinceLastOOSVisit_LY\",\"precision\":10,\"saqlExpression\":\"daysBetween(toDate('ActualVisitStartTime_sec_epoch'), toDate('LastOOSVisit.ActualVisitStartTime_LS_SamePeriod_LY_sec_epoch'))\",\"scale\":0,\"type\":\"Numeric\"},{\"format\":\"yyyy-MM-dd\",\"isYearEndFiscalYear\":true,\"label\":\"LatestPromotionStartDatePast_TD_Temp\",\"name\":\"LatestPromotionStartDatePast_TD_Temp\",\"saqlExpression\":\"case when 'LatestPromotionStartDatePast_Temp_sec_epoch' <= 'LastOOSVisit.ActualVisitStartTime_sec_epoch' then toDate('LatestPromotionStartDatePast_Temp', \\\"yyyy-MM-dd\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd\",\"isYearEndFiscalYear\":true,\"label\":\"LatestPromotionEndDatePast_TD_Temp\",\"name\":\"LatestPromotionEndDatePast_TD_Temp\",\"saqlExpression\":\"case when 'LatestPromotionEndDatePast_Temp_sec_epoch' <= 'LastOOSVisit.ActualVisitStartTime_sec_epoch' then toDate('LatestPromotionEndDatePast_Temp', \\\"yyyy-MM-dd\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd\",\"isYearEndFiscalYear\":true,\"label\":\"LatestPromotionEndDateFuture_TD_Temp\",\"name\":\"LatestPromotionEndDateFuture_TD_Temp\",\"saqlExpression\":\"case when 'LatestPromotionEndDateFuture_Temp_sec_epoch' >= 'LastOOSVisit.ActualVisitStartTime_sec_epoch' then toDate('LatestPromotionEndDateFuture_Temp', \\\"yyyy-MM-dd\\\") end\",\"type\":\"Date\"}],\"mergeWithSource\":true},\"sources\":[\"CG_ED_Story_TD_Augment_StoreProductLastOOSVisitDate_onto_RetailVisitKpi\"]},\"CG_ED_Story_Augment_RetailVisitKpi_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"RetailVisitKpi\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"SoS_Compliance_Temp\",\"SoS_Tasks_Count\",\"OutOfStock_Compliance_Temp\",\"OutOfStock_Tasks_Count\",\"Promotion_Compliance_Temp\",\"Promotion_Tasks_Count\",\"Facing_Compliance_Temp\",\"Facing_Tasks_Count\",\"Inventory_Compliance_Temp\",\"Inventory_Tasks_Count\",\"StoreProduct_Visits\",\"Number_of_Promotions\"]},\"sources\":[\"CG_ED_Story_Augment_OrderItem_DaysSinceLastOrder_onto_StoreProduct\",\"CG_ED_Story_CR_RetailVisitKpi_GetPromoCount\"]},\"CG_ED_Story_CR_PromotionChannel_GetLatestPromotionEndDateFuture\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"EndDate_Computed\"},\"label\":\"LatestPromotionEndDateFuture\",\"name\":\"LatestPromotionEndDateFuture\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"DaysAfterPromotionEnds\"}],\"partitionBy\":[\"PromotionId\"]},\"sources\":[\"CG_ED_Story_Filter_PromotionChannel_KeepLatestPromotionEndDateFuture\"]},\"CG_ED_Story_Augment_AssessmentTaskOrder_onto_Order\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Id\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"AssessmentTaskOrder\",\"rightKey\":[\"OrderId\"],\"rightSelect\":[\"AssessmentTask.Visit.PlaceId\",\"AssessmentTask.Visit.Id\"]},\"sources\":[\"CG_ED_Story_Digest_Order\",\"CG_ED_Story_Augment_AssessmentTask_onto_AssessmentTaskOrder\"]},\"CG_ED_Story_Augment_LatestPromotionEndDatePast_onto_RetailVisitKpi\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"PromotionId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Promotion\",\"rightKey\":[\"PromotionId\"],\"rightSelect\":[\"LatestPromotionEndDatePast\"]},\"sources\":[\"CG_ED_Story_Augment_LatestPromotionStartDatePast_onto_RetailVisitKpi\",\"CG_ED_Story_CR_PromotionChannel_GetLatestPromotionEndDatePast\"]},\"CG_ED_Story_CE_OrderItem\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Quantity_Current_Period\",\"name\":\"Quantity_Current_Period\",\"precision\":10,\"saqlExpression\":\"case when date('Order.ActivatedDate_Year', 'Order.ActivatedDate_Month', 'Order.ActivatedDate_Day') in [\\\"90 days ago\\\"..\\\"current day\\\"] then 'Quantity' else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Quantity_Previous_Period\",\"name\":\"Quantity_Previous_Period\",\"precision\":10,\"saqlExpression\":\"case when date('Order.ActivatedDate_Year', 'Order.ActivatedDate_Month', 'Order.ActivatedDate_Day') in [\\\"181 days ago\\\"..\\\"91 days ago\\\"] then 'Quantity' else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Quantity_Coming_Period_LastYear\",\"name\":\"Quantity_Coming_Period_LastYear\",\"precision\":10,\"saqlExpression\":\"case when date('Order.ActivatedDate_Year', 'Order.ActivatedDate_Month', 'Order.ActivatedDate_Day') in [\\\"1 day ahead - 1 year\\\"..\\\"91 days ahead - 1 year\\\"] then 'Quantity' else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"DaysSinceLastOrder_FromLastVisit\",\"name\":\"DaysSinceLastOrder_FromLastVisit\",\"precision\":10,\"saqlExpression\":\"daysBetween(toDate('Order.ActivatedDate_sec_epoch'), toDate('StoreProductTD.ActualVisitStartTime_sec_epoch')) \",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"DaysSinceLastOrder_LY_FromLastVisit\",\"name\":\"DaysSinceLastOrder_LY_FromLastVisit\",\"precision\":10,\"saqlExpression\":\"daysBetween(toDate('StoreProductTD.ActualVisitStartTime_FS_ComingPeriod_LY_sec_epoch'), toDate('Order.ActivatedDate_sec_epoch')) \",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Quantity_Current_Period_TD\",\"name\":\"Quantity_Current_Period_TD\",\"precision\":10,\"saqlExpression\":\"case when 'DaysSinceLastOrder_FromLastVisit' >=0 && 'DaysSinceLastOrder_FromLastVisit' <= 90 then 'Quantity' else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Quantity_Previous_Period_TD\",\"name\":\"Quantity_Previous_Period_TD\",\"precision\":10,\"saqlExpression\":\"case when 'DaysSinceLastOrder_FromLastVisit' >= 181 && 'DaysSinceLastOrder_FromLastVisit' <= 91 then 'Quantity' else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Quantity_Coming_Period_LastYear_TD\",\"name\":\"Quantity_Coming_Period_LastYear_TD\",\"precision\":10,\"saqlExpression\":\"case when 'DaysSinceLastOrder_LY_FromLastVisit' >=0 && 'DaysSinceLastOrder_LY_FromLastVisit' <= 90 then 'Quantity' else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"StoreProductId\",\"name\":\"StoreProductId\",\"saqlExpression\":\"'Order.AssessmentTaskOrder.AssessmentTask.Visit.PlaceId' +\\\"-\\\"+'Product2Id'\",\"type\":\"Text\"},{\"label\":\"StoreProduct_Exists_Flag\",\"name\":\"StoreProduct_Exists_Flag\",\"precision\":10,\"saqlExpression\":\"case when 'Order.AssessmentTaskOrder.AssessmentTask.Visit.PlaceId' is not null && 'Product2Id' is not null then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"RetailStoreId\",\"name\":\"RetailStoreId\",\"saqlExpression\":\"'Order.AssessmentTaskOrder.AssessmentTask.Visit.PlaceId'\",\"type\":\"Text\"},{\"label\":\"ProductId\",\"name\":\"ProductId\",\"saqlExpression\":\"'Product2Id'\",\"type\":\"Text\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"isYearEndFiscalYear\":true,\"label\":\"ActivatedDate_Computed\",\"name\":\"ActivatedDate_Computed\",\"saqlExpression\":\"case when daysBetween(toDate('Order.ActivatedDate_sec_epoch'), now()) >= 0 then toDate('Order.ActivatedDate_sec_epoch') end\",\"type\":\"Date\"},{\"label\":\"DaysSinceLastOrder_SD\",\"name\":\"DaysSinceLastOrder_SD\",\"precision\":10,\"saqlExpression\":\"daysBetween(toDate('Order.ActivatedDate_sec_epoch'), now()) \",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"CG_ED_Story_TD_Augment_StoreProduct_onto_OrderItem\"]},\"CG_ED_Story_Augment_OrderItem_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"OrderItem\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"Quantity_Current_Period\",\"Quantity_Previous_Period\",\"Quantity_Coming_Period_LastYear\"]},\"sources\":[\"CG_ED_Story_Augment_ProductCategory_onto_StoreProduct\",\"CG_ED_Story_CE_OrderItem\"]},\"CG_ED_Story_CE_StoreProduct_ComputeValues\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"State - City\",\"name\":\"State_City\",\"saqlExpression\":\"'RetailStore.Location.Address.State' +\\\" - \\\"+'RetailStore.Location.Address.City'\",\"type\":\"Text\"},{\"label\":\"Quantity_Change_Percentage_vs_Previous_Period\",\"name\":\"Quantity_Change_Percentage_vs_Previous_Period\",\"precision\":10,\"saqlExpression\":\"('OrderItem.Quantity_Current_Period' - 'OrderItem.Quantity_Previous_Period') / 'OrderItem.Quantity_Previous_Period'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Quantity_Change_Percentage_vs_Coming_Period_LastYear\",\"name\":\"Quantity_Change_Percentage_vs_Coming_Period_LastYear\",\"precision\":10,\"saqlExpression\":\"('OrderItem.Quantity_Current_Period' - 'OrderItem.Quantity_Coming_Period_LastYear') / 'OrderItem.Quantity_Coming_Period_LastYear'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"SoS Compliance\",\"name\":\"ShareOfShelf_Compliance\",\"precision\":10,\"saqlExpression\":\"'RetailVisitKpi.SoS_Compliance_Temp' / 'RetailVisitKpi.SoS_Tasks_Count'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"OOS Compliance\",\"name\":\"OutOfStock_Compliance\",\"precision\":10,\"saqlExpression\":\"'RetailVisitKpi.OutOfStock_Compliance_Temp' / 'RetailVisitKpi.OutOfStock_Tasks_Count'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Facing Compliance\",\"name\":\"Facing_Compliance\",\"precision\":10,\"saqlExpression\":\"'RetailVisitKpi.Facing_Compliance_Temp' / 'RetailVisitKpi.Facing_Tasks_Count'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Promotion Compliance\",\"name\":\"Promotion_Compliance\",\"precision\":10,\"saqlExpression\":\"'RetailVisitKpi.Promotion_Compliance_Temp' / 'RetailVisitKpi.Promotion_Tasks_Count'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Inventory Compliance\",\"name\":\"Inventory_Compliance\",\"precision\":10,\"saqlExpression\":\"'RetailVisitKpi.Inventory_Compliance_Temp' / 'RetailVisitKpi.Inventory_Tasks_Count'\",\"scale\":2,\"type\":\"Numeric\"},{\"format\":\"yyyy-MM-dd\",\"isYearEndFiscalYear\":true,\"label\":\"LatestPromotionStartDatePast\",\"name\":\"LatestPromotionStartDatePast\",\"saqlExpression\":\"case when toDate('Promotion.LatestPromotionStartDatePast', \\\"yyyy-MM-dd\\\") != toDate(\\\"1970-01-01\\\", \\\"yyyy-MM-dd\\\") then toDate('Promotion.LatestPromotionStartDatePast', \\\"yyyy-MM-dd\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd\",\"isYearEndFiscalYear\":true,\"label\":\"LatestPromotionEndDatePast\",\"name\":\"LatestPromotionEndDatePast\",\"saqlExpression\":\"case when toDate('Promotion.LatestPromotionEndDatePast', \\\"yyyy-MM-dd\\\") != toDate(\\\"1970-01-01\\\", \\\"yyyy-MM-dd\\\") then toDate('Promotion.LatestPromotionEndDatePast', \\\"yyyy-MM-dd\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd\",\"isYearEndFiscalYear\":true,\"label\":\"LatestPromotionEndDateFuture\",\"name\":\"LatestPromotionEndDateFuture\",\"saqlExpression\":\"case when toDate('Promotion.LatestPromotionEndDateFuture', \\\"yyyy-MM-dd\\\") != toDate(\\\"1970-01-01\\\", \\\"yyyy-MM-dd\\\") then toDate('Promotion.LatestPromotionEndDateFuture', \\\"yyyy-MM-dd\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"isYearEndFiscalYear\":true,\"label\":\"Last_Visit_Date\",\"name\":\"Last_Visit_Date\",\"saqlExpression\":\"toDate(date_to_epoch(now())+86399 - (date_to_epoch(now())- (86400 * floor(date_to_epoch(now())/86400))))\",\"type\":\"Date\"},{\"label\":\"Quantity_Current_Period\",\"name\":\"Quantity_Current_Period\",\"precision\":10,\"saqlExpression\":\"'OrderItem.Quantity_Current_Period'\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Quantity_Previous_Period\",\"name\":\"Quantity_Previous_Period\",\"precision\":10,\"saqlExpression\":\"'OrderItem.Quantity_Previous_Period'\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Quantity_Coming_Period_LastYear\",\"name\":\"Quantity_Coming_Period_LastYear\",\"precision\":10,\"saqlExpression\":\"'OrderItem.Quantity_Coming_Period_LastYear'\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Store_Visits\",\"name\":\"Store_Visits\",\"precision\":10,\"saqlExpression\":\"'Store.Number_of_Visits'\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Dataset Type\",\"name\":\"Dataset_Type\",\"saqlExpression\":\"\\\"SD\\\"\",\"type\":\"Text\"},{\"label\":\"OOS_Kpi_ActualValue\",\"name\":\"OOS_Kpi_ActualValue\",\"saqlExpression\":\"\\\"\\\"\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"CG_ED_Story_Augment_RetailVisitKpiWithPromotionDates_onto_StoreProduct\"]},\"CG_ED_Story_Filter_RetailVisitKpi_DaysSinceLastComplianceCheck\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"Include_In_Compliance == \\\"True\\\"\"},\"sources\":[\"CG_ED_Story_CE_RetailVisitKpi_ComputeValues\"]},\"CG_ED_Story_TD_Filter_RetailVisitKpi_LY_SamePeriod_Promotions\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'DaysSinceLastOOSVisit_LY'>=0 && 'DaysSinceLastOOSVisit_LY' <= 90 && 'PromotionId' is not null\"},\"sources\":[\"CG_ED_Story_TD_CE_RetailVisitKpi_ComputeValues\"]},\"CG_ED_Story_Augment_AID_onto_RetailVisitKpi\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"AssessmentIndDefinitionId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"AssessmentIndicatorDefinition\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"DataType\"]},\"sources\":[\"CG_ED_Story_Digest_RetailVisitKpi\",\"CG_ED_Story_Digest_AssessmentIndicatorDefinition\"]},\"CG_ED_Story_TD_Augment_OrderItem_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"OrderItem\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"Quantity_Current_Period_TD\",\"Quantity_Previous_Period_TD\",\"Quantity_Coming_Period_LastYear_TD\"]},\"sources\":[\"CG_ED_Story_TD_Filter_StoreProduct\",\"CG_ED_Story_CE_OrderItem\"]},\"CG_ED_Story_TD_Slice_StoreProduct_Final\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"StoreProduct.InStoreLocationType_Shelf\"},{\"name\":\"StoreProduct.InStoreLocationType_Bin\"},{\"name\":\"StoreProduct.InStoreLocationType_Backroom\"},{\"name\":\"StoreProduct.InStoreLocationType_Assets\"},{\"name\":\"StoreProduct.InStoreLocationType_Other\"},{\"name\":\"StoreProduct.Favorite\"},{\"name\":\"RetailStore.StoreType\"},{\"name\":\"RetailStore.Priority\"},{\"name\":\"RetailStore.Name\"},{\"name\":\"RetailStore.RetailStoreGroup.Name\"},{\"name\":\"Product.Name\"},{\"name\":\"Product.Family\"},{\"name\":\"Product.ProductCategory.Name\"},{\"name\":\"OrderItem.DaysSinceLastOrder\"},{\"name\":\"RetailVisitKpi.StoreProduct_Visits\"},{\"name\":\"RetailVisitKpi.Number_of_Promotions\"},{\"name\":\"Compliance.DaysSinceLastComplianceCheck\"},{\"name\":\"OutOfStock.DaysSinceOOSComplianceCheck\"},{\"name\":\"OutOfStock.OOS_Actual\"},{\"name\":\"Inventory.DaysSinceInventoryComplianceCheck\"},{\"name\":\"Inventory.Inventory_Actual\"},{\"name\":\"Inventory.Inventory_Target\"},{\"name\":\"LastYearSamePeriod.Number_of_Promotions\"},{\"name\":\"State_City\"},{\"name\":\"Quantity_Change_Percentage_vs_Previous_Period\"},{\"name\":\"Quantity_Change_Percentage_vs_Coming_Period_LastYear\"},{\"name\":\"ShareOfShelf_Compliance\"},{\"name\":\"OutOfStock_Compliance\"},{\"name\":\"Facing_Compliance\"},{\"name\":\"Promotion_Compliance\"},{\"name\":\"Inventory_Compliance\"},{\"name\":\"Quantity_Current_Period\"},{\"name\":\"Quantity_Previous_Period\"},{\"name\":\"Quantity_Coming_Period_LastYear\"},{\"name\":\"Store_Visits\"},{\"name\":\"OOS_Kpi_ActualValue\"},{\"name\":\"LatestPromotionStartDatePast\"},{\"name\":\"LatestPromotionEndDatePast\"},{\"name\":\"LatestPromotionEndDateFuture\"}],\"mode\":\"select\"},\"sources\":[\"CG_ED_Story_TD_CE_StoreProduct_ComputeValues\"]},\"CG_ED_Story_Filter_PromotionChannel_KeepLatestPromotionStartDatePast\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"ChannelPriority_Flag == 1 && DaysSincePromotionStarted >= 0\"},\"sources\":[\"CG_ED_Story_CR_PromotionChannel\"]},\"CG_ED_Story_TD_Filter_RetailVisitKpi_DaysSinceLastInventoryComplianceCheck\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"Type == \\\"Inventory\\\"\"},\"sources\":[\"CG_ED_Story_TD_Filter_RetailVisitKpi_DaysSinceLastComplianceCheck\"]},\"CG_ED_Story_TD_CR_OrderItem_GetDaysSinceLastOrder_SinceLWD\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"saqlExpression\":\"first('DaysSinceLastOrder_FromLastVisit')\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"DaysSinceLastOrder\",\"name\":\"DaysSinceLastOrder\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"Order.ActivatedDate\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_TD_Filter_OrderItem_GetOrdersBeforeLVD\"]},\"CG_ED_Story_CR_OrderItem_GetDaysSinceLastOrder\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"saqlExpression\":\"daysBetween(toDate(first('Order.ActivatedDate_sec_epoch')), now())\",\"type\":\"Numeric\",\"scale\":10},\"label\":\"Days Since Last Order\",\"name\":\"DaysSinceLastOrder\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"Order.ActivatedDate\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_Filter_OrderItem_GetOrdersBeforeToday\"]},\"CG_ED_Story_Digest_OrderItem\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"AvailableQuantity\"},{\"name\":\"Id\"},{\"name\":\"UnitPrice\"},{\"name\":\"TotalPrice\"},{\"name\":\"Quantity\"},{\"name\":\"Product2Id\"},{\"name\":\"OrderItemNumber\"},{\"name\":\"OrderId\"},{\"name\":\"ListPrice\"},{\"name\":\"IsDeleted\"}],\"object\":\"OrderItem\"}},\"CG_ED_Story_TD_CR_RetailVisitKpi_GetPromoCount\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"saqlExpression\":\"case when 'PromotionId' is not null then case when current('PromotionId') == previous('PromotionId') then 0 else 1 end end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Number_of_Promotions\",\"name\":\"Number_of_Promotions\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"PromotionId\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_TD_CR_RetailVisitKpi_GetStoreProductVisits\"]},\"CG_ED_Story_Promotion_onto_PromotionChannel\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"PromotionId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Promotion\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"EndDate\"]},\"sources\":[\"CG_ED_Story_Digest_PromotionChannel\",\"CG_ED_Story_Digest_Promotion\"]},\"CG_ED_Story_Digest_AssessmentIndicatorDefinition\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"DataType\"},{\"name\":\"Name\"},{\"name\":\"Id\"},{\"name\":\"Description\"}],\"object\":\"AssessmentIndicatorDefinition\"}},\"CG_ED_Story_CE_AssessmentTaskOrder_Find_Duplicate_Orders\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"IsDuplicate\",\"name\":\"IsDuplicate\",\"saqlExpression\":\"case when 'OrderId' == 'OrderIdPrevious' then \\\"True\\\" else \\\"False\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"CG_ED_Story_CR_AssessmentTaskOrder_Find_Previous_Orders\"]},\"CG_ED_Story_Slice_StoreProduct\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"StoreProduct.InStoreLocationType_Shelf\"},{\"name\":\"StoreProduct.InStoreLocationType_Bin\"},{\"name\":\"StoreProduct.InStoreLocationType_Backroom\"},{\"name\":\"StoreProduct.InStoreLocationType_Assets\"},{\"name\":\"StoreProduct.InStoreLocationType_Other\"},{\"name\":\"StoreProduct.Favorite\"},{\"name\":\"RetailStore.StoreType\"},{\"name\":\"RetailStore.Priority\"},{\"name\":\"RetailStore.Name\"},{\"name\":\"RetailStore.RetailStoreGroup.Name\"},{\"name\":\"Product.Name\"},{\"name\":\"Product.Family\"},{\"name\":\"Product.ProductCategory.Name\"},{\"name\":\"OrderItem.DaysSinceLastOrder\"},{\"name\":\"RetailVisitKpi.StoreProduct_Visits\"},{\"name\":\"RetailVisitKpi.Number_of_Promotions\"},{\"name\":\"LastYearSamePeriod.Number_of_Promotions\"},{\"name\":\"Compliance.DaysSinceLastComplianceCheck\"},{\"name\":\"OutOfStock.DaysSinceOOSComplianceCheck\"},{\"name\":\"OutOfStock.OOS_Actual\"},{\"name\":\"Inventory.DaysSinceInventoryComplianceCheck\"},{\"name\":\"Inventory.Inventory_Actual\"},{\"name\":\"Inventory.Inventory_Target\"},{\"name\":\"State_City\"},{\"name\":\"Quantity_Change_Percentage_vs_Previous_Period\"},{\"name\":\"Quantity_Change_Percentage_vs_Coming_Period_LastYear\"},{\"name\":\"ShareOfShelf_Compliance\"},{\"name\":\"OutOfStock_Compliance\"},{\"name\":\"Facing_Compliance\"},{\"name\":\"Promotion_Compliance\"},{\"name\":\"Inventory_Compliance\"},{\"name\":\"LatestPromotionStartDatePast\"},{\"name\":\"LatestPromotionEndDatePast\"},{\"name\":\"LatestPromotionEndDateFuture\"},{\"name\":\"Quantity_Current_Period\"},{\"name\":\"Quantity_Previous_Period\"},{\"name\":\"Quantity_Coming_Period_LastYear\"},{\"name\":\"Store_Visits\"},{\"name\":\"OOS_Kpi_ActualValue\"}],\"mode\":\"select\"},\"sources\":[\"CG_ED_Story_CE_StoreProduct_ComputeValues\"]},\"CG_ED_Story_Augment_Address_onto_Location\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"VisitorAddressId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Address\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"City\",\"State\"]},\"sources\":[\"CG_ED_Story_Digest_Location\",\"CG_ED_Story_Digest_Address\"]},\"CG_ED_Story_Augment_AssessmentTask_onto_RetailVisitKpi\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"AssessmentTaskId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"AssessmentTask\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"TaskType\",\"Visit.ActualVisitStartTime\",\"Visit.Id\",\"Visit.Status\",\"Visit.PlaceId\",\"Visit.ActualVisitStartTime_SelectedPeriod_Filter_Flag\",\"Visit.VisitsUntilCurrentTime_Flag\",\"Visit.ActualVisitStartTime_LastYear_SamePeriod_Filter_Flag\",\"Visit.CurrentDay\"]},\"sources\":[\"CG_ED_Story_Augment_AID_onto_RetailVisitKpi\",\"CG_ED_Story_Augment_Visit_onto_AssessmentTask\"]},\"CG_ED_Story_CR_RetailVisitKpi_GetStoreProductVisits\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"saqlExpression\":\"case when current('AssessmentTask.Visit.Id') == previous('AssessmentTask.Visit.Id') then 0 else 1 end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"StoreProduct_Visits\",\"name\":\"StoreProduct_Visits\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"AssessmentTask.Visit.Id\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_Filter_RetailVisitKpi\"]},\"CG_ED_Story_Filter_RetailVisitKpi_GetStoreProduct\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'Unique_StoreProduct_Flag' == 1 && 'StoreProduct_Exists_Flag' == 1\"},\"sources\":[\"CR_ED_Story_CR_RetailVisitKpi_GetStoreProduct\"]},\"CG_ED_Story_Augment_ProductCategory_onto_ProductCategoryProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ProductCategoryId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"ProductCategory\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"CG_ED_Story_Digest_ProductCategoryProduct\",\"CG_ED_Story_Digest_ProductCategory\"]},\"CG_ED_Story_Digest_Product\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Name\"},{\"name\":\"Id\"},{\"name\":\"Family\"}],\"object\":\"Product2\"}},\"CG_ED_Story_TD_CR_RetailVisitKpi_DaysSinceLastComplianceCheck\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"saqlExpression\":\"daysBetween(toDate(first('ActualVisitStartTime_sec_epoch')), toDate('LastOOSVisit.ActualVisitStartTime_sec_epoch'))\",\"type\":\"Numeric\",\"scale\":2},\"label\":\"Days Since Last Compliance Check\",\"name\":\"DaysSinceLastComplianceCheck\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"ActualVisitStartTime\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_TD_Filter_RetailVisitKpi_DaysSinceLastComplianceCheck\"]},\"CG_ED_Story_Filter_RetailVisitKpi_GetPromotions\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'PromotionId' is not null\"},\"sources\":[\"CG_ED_Story_CE_RetailVisitKpi_ComputeValues\"]},\"CG_ED_Story_Digest_RetailStoreGroup\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Name\"}],\"object\":\"RetailLocationGroup\"}},\"CG_ED_Story_Digest_Address\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"City\"},{\"name\":\"Country\"},{\"name\":\"State\"},{\"name\":\"Name\"},{\"name\":\"Id\"}],\"object\":\"Address\"}},\"CG_ED_Story_CR_PromotionChannel_GetLatestPromotionEndDatePast\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"EndDate_Computed\"},\"label\":\"LatestPromotionEndDatePast\",\"name\":\"LatestPromotionEndDatePast\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"DaysSincePromotionEnded\"}],\"partitionBy\":[\"PromotionId\"]},\"sources\":[\"CG_ED_Story_Filter_PromotionChannel_KeepLatestPromotionEndDatePast\"]},\"CG_ED_Story_Filter_RetailVisitKpi_LY_SamePeriod_Promotions\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'AssessmentTask.Visit.ActualVisitStartTime_LastYear_SamePeriod_Filter_Flag' == 1 && 'PromotionId' is not null\"},\"sources\":[\"CG_ED_Story_CE_RetailVisitKpi_ComputeValues\"]},\"CG_ED_Story_Digest_Visit\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"ActualVisitEndTime\"},{\"name\":\"ActualVisitStartTime\"},{\"name\":\"Id\"},{\"name\":\"CreatedDate\"},{\"name\":\"VisitPriority\"},{\"name\":\"VisitorId\"},{\"name\":\"Status\"},{\"name\":\"PlannedVisitStartTime\"},{\"name\":\"PlannedVisitEndTime\"},{\"name\":\"PlaceId\"},{\"name\":\"Name\"}],\"object\":\"Visit\"}},\"CG_ED_Story_TD_Augment_RetailVisitKpi_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"RetailVisitKpi\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"SoS_Compliance_Temp\",\"SoS_Tasks_Count\",\"OutOfStock_Compliance_Temp\",\"OutOfStock_Tasks_Count\",\"Promotion_Compliance_Temp\",\"Promotion_Tasks_Count\",\"Facing_Compliance_Temp\",\"Facing_Tasks_Count\",\"Inventory_Compliance_Temp\",\"Inventory_Tasks_Count\",\"Number_of_Promotions\",\"StoreProduct_Visits\"]},\"sources\":[\"CG_ED_Story_TD_Augment_OrderItem_DaysSinceLastOrder_onto_StoreProduct\",\"CG_ED_Story_TD_CR_RetailVisitKpi_GetPromoCount\"]},\"CG_ED_Story_Augment_RetailVisitKpi_LYSamePeriodPromotions_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"LastYearSamePeriod\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"Number_of_Promotions\"]},\"sources\":[\"CG_ED_Story_Augment_RetailVisitKpi_onto_StoreProduct\",\"CG_ED_Story_CR_RetailVisitKpi_LY_SamePeriod_Promotions\"]},\"CG_ED_Story_Digest_StoreProduct\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"InStoreLocationId\"},{\"name\":\"ProductId\"},{\"name\":\"RetailStoreId\"},{\"name\":\"IsFavorite\"}],\"object\":\"StoreProduct\"}},\"CG_ED_Story_Augment_DaysSinceLastInventoryComplianceCheck_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Inventory\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"DaysSinceInventoryComplianceCheck\",\"Inventory_Actual\",\"Inventory_Target\"]},\"sources\":[\"CG_ED_Story_Augment_DaysSinceLastOOSComplianceCheck_onto_StoreProduct\",\"CG_ED_Story_CR_RetailVisitKpi_DaysSinceLastInventoryComplianceCheck\"]},\"CG_ED_Story_CE_StoreProduct\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"InStoreLocationType_Shelf\",\"name\":\"InStoreLocationType_Shelf\",\"saqlExpression\":\"case when 'InStoreLocation.InStoreLocationType' == \\\"Shelf\\\" then \\\"Yes\\\" else \\\"No\\\" end \",\"type\":\"Text\"},{\"label\":\"InStoreLocationType_Bin\",\"name\":\"InStoreLocationType_Bin\",\"saqlExpression\":\"case when 'InStoreLocation.InStoreLocationType' == \\\"Bin\\\" then \\\"Yes\\\" else \\\"No\\\" end \",\"type\":\"Text\"},{\"label\":\"InStoreLocationType_Backroom\",\"name\":\"InStoreLocationType_Backroom\",\"saqlExpression\":\"case when 'InStoreLocation.InStoreLocationType' == \\\"Backroom\\\" then \\\"Yes\\\" else \\\"No\\\" end \",\"type\":\"Text\"},{\"label\":\"InStoreLocationType_Assets\",\"name\":\"InStoreLocationType_Assets\",\"saqlExpression\":\"case when 'InStoreLocation.InStoreLocationType' == \\\"Assets\\\" then \\\"Yes\\\" else \\\"No\\\" end \",\"type\":\"Text\"},{\"label\":\"InStoreLocationType_Other\",\"name\":\"InStoreLocationType_Other\",\"saqlExpression\":\"case when 'InStoreLocation.InStoreLocationType' == \\\"Other\\\" then \\\"Yes\\\" else \\\"No\\\" end \",\"type\":\"Text\"},{\"label\":\"Favorite\",\"name\":\"Favorite\",\"saqlExpression\":\"case when 'IsFavorite' == \\\"true\\\" then \\\"Yes\\\" when 'IsFavorite' == \\\"false\\\" then \\\"No\\\" end \",\"type\":\"Text\"},{\"label\":\"StoreProductId\",\"name\":\"StoreProductId\",\"saqlExpression\":\"'RetailStoreId' +\\\"-\\\"+'ProductId'\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"CG_ED_Story_Augment_InStoreLocation_onto_StoreProduct\"]},\"CG_ED_Story_TD_Augment_RetailVisitKpi_LYSamePeriodPromotions_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LastYearSamePeriod\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"Number_of_Promotions\"]},\"sources\":[\"CG_ED_Story_TD_Augment_StoreVisits_onto_StoreProduct\",\"CG_ED_Story_TR_CR_RetailVisitKpi_LY_SamePeriod_Promotions\"]},\"CG_ED_Story_Filter_OrderItem_GetOrdersBeforeToday\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'Order.AssessmentTaskOrder.AssessmentTask.Visit.Id' is not null && 'DaysSinceLastOrder_SD'>= 0\"},\"sources\":[\"CG_ED_Story_CE_OrderItem\"]},\"CG_ED_Story_Digest_Order\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"AccountId\"},{\"name\":\"ActivatedDate\"},{\"name\":\"Type\"},{\"name\":\"OrderNumber\"},{\"name\":\"Id\"}],\"object\":\"Order\"}},\"CG_ED_Story_TD_Filter_StoreProduct\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'TD.ActualBooleanValue' is not null\"},\"sources\":[\"CG_ED_Story_Augment_StoreProductTD_onto_StoreProductSD\"]},\"CG_ED_Story_Augment_DaysSinceLastComplianceCheck_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Compliance\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"DaysSinceLastComplianceCheck\"]},\"sources\":[\"CG_ED_Story_Augment_RetailVisitKpi_LYSamePeriodPromotions_onto_StoreProduct\",\"CG_ED_Story_CR_RetailVisitKpi_DaysSinceLastComplianceCheck\"]},\"CG_ED_Story_Digest_AssessmentTaskOrder\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"AssessmentTaskId\"},{\"name\":\"Id\"},{\"name\":\"CreatedDate\"},{\"name\":\"LastModifiedDate\"},{\"name\":\"OrderId\"},{\"name\":\"RetailStoreId\"}],\"object\":\"AssessmentTaskOrder\"}},\"CG_ED_Story_Augment_RetailStore_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"RetailStoreId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"RetailStore\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Priority\",\"Name\",\"RetailStoreGroup.Name\",\"Location.Address.City\",\"Location.Address.State\",\"StoreType\"]},\"sources\":[\"CG_ED_Story_Augment_StoreProductwithInStoreLocation_onto_StoreProduct\",\"CG_ED_Story_Augment_Location_onto_RetailStore\"]},\"CG_ED_Story_TD_Augment_DaysSinceLastComplianceCheck_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Compliance\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"DaysSinceLastComplianceCheck\"]},\"sources\":[\"CG_ED_Story_TD_Augment_RetailVisitKpi_onto_StoreProduct\",\"CG_ED_Story_TD_CR_RetailVisitKpi_DaysSinceLastComplianceCheck\"]},\"CG_ED_Story_TD_Augment_DaysSinceLastInventoryComplianceCheck_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Inventory\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"DaysSinceInventoryComplianceCheck\",\"Inventory_Actual\",\"Inventory_Target\"]},\"sources\":[\"CG_ED_Story_TD_Augment_DaysSinceLastOOSComplianceCheck_onto_StoreProduct\",\"CG_ED_Story_TD_CR_RetailVisitKpi_DaysSinceLastInventoryComplianceCheck\"]},\"CG_ED_Story_Augment_LatestPromotionStartDatePast_onto_RetailVisitKpi\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"PromotionId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Promotion\",\"rightKey\":[\"PromotionId\"],\"rightSelect\":[\"LatestPromotionStartDatePast\"]},\"sources\":[\"CG_ED_Story_Filter_RetailVisitKpi_with_VisitStatus\",\"CG_ED_Story_CR_PromotionChannel_GetLatestPromotionStartDatePast\"]},\"CG_ED_Story_Filter_RetailVisitKpi_DaysSinceLastOOSComplianceCheck\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"Type == \\\"OutOfStock\\\"\"},\"sources\":[\"CG_ED_Story_Filter_RetailVisitKpi_DaysSinceLastComplianceCheck\"]},\"CG_ED_Story_TD_Filter_RetailVisitKpi_DaysSinceLastOOSComplianceCheck\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"Type == \\\"OutOfStock\\\"\"},\"sources\":[\"CG_ED_Story_TD_Filter_RetailVisitKpi_DaysSinceLastComplianceCheck\"]},\"CG_ED_Story_Augment_RetailStoreGroup_onto_RetailStore\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"RetailLocationGroupId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"RetailStoreGroup\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"CG_ED_Story_Digest_RetailStore\",\"CG_ED_Story_Digest_RetailStoreGroup\"]},\"CG_ED_Story_Append_TD_SD_Data\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":true},\"sources\":[\"CG_ED_Story_TD_Slice_StoreProduct_Final\",\"CG_ED_Story_Slice_StoreProduct\"]},\"CG_ED_Story_Digest_ProductCategoryProduct\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"ProductCategoryId\"},{\"name\":\"ProductId\"}],\"object\":\"ProductCategoryProduct\"}},\"CG_ED_Story_CR_RetailVisitKpi_GetLatestPromotionStartDatePast\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"LatestPromotionStartDatePast_Temp\"},\"label\":\"LatestPromotionStartDatePast\",\"name\":\"LatestPromotionStartDatePast\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"LatestPromotionStartDatePast_Temp\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_Filter_RetailVisitKpi_GetPromotions\"]},\"CG_ED_Story_Augment_ProductCategory_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ProductId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"Product\",\"rightKey\":[\"ProductId\"],\"rightSelect\":[\"ProductCategory.Name\"]},\"sources\":[\"CG_ED_Story_Augment_Product_onto_StoreProduct\",\"CG_ED_Story_Augment_ProductCategory_onto_ProductCategoryProduct\"]},\"CG_ED_Story_Augment_StoreProductwithInStoreLocation_onto_StoreProduct\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"StoreProduct\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"InStoreLocationType_Assets\",\"InStoreLocationType_Backroom\",\"InStoreLocationType_Bin\",\"InStoreLocationType_Other\",\"InStoreLocationType_Shelf\",\"Favorite\"]},\"sources\":[\"CG_ED_Story_Slice_StoreProduct_GetStoreProduct\",\"CG_ED_Story_CE_StoreProduct\"]},\"CR_ED_Story_CR_RetailVisitKpi_GetStoreProduct\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"saqlExpression\":\"case when current('StoreProductId') == previous('StoreProductId') then 0 else 1 end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Unique_StoreProduct_Flag\",\"name\":\"Unique_StoreProduct_Flag\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"StoreProductId\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_CE_RetailVisitKpi_ComputeValues\"]},\"CG_ED_Story_CR_RetailVisitKpi_GetLatestPromotionEndDatePast\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"LatestPromotionEndDatePast_Temp\"},\"label\":\"LatestPromotionEndDatePast\",\"name\":\"LatestPromotionEndDatePast\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"LatestPromotionEndDatePast_Temp\"}],\"partitionBy\":[\"StoreProductId\"]},\"sources\":[\"CG_ED_Story_CR_RetailVisitKpi_GetLatestPromotionStartDatePast\"]},\"CG_ED_Story_TD_Augment_StoreProductLastOOSVisitDate_onto_RetailVisitKpi\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"StoreProductId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LastOOSVisit\",\"rightKey\":[\"StoreProductId\"],\"rightSelect\":[\"ActualVisitStartTime\",\"ActualVisitStartTime_LS_SamePeriod_LY\"]},\"sources\":[\"CG_ED_Story_CE_RetailVisitKpi_ComputeValues\",\"CG_ED_Story_TD_Filter_RetailVisitKpi_OOS_LastVisitRecords\"]}}}",null]